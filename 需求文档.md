# 乐器循环录音 App - 产品需求文档

## 1. 产品概述

### 1.1 产品名称
乐器循环录音 App（建议名称：乐起 / LoopBeat / 一人乐队）

### 1.2 产品定位
一款面向音乐爱好者的实时循环录音应用，让用户通过敲击、人声、乐器等多种音源进行多轨录音与叠加，实现一人乐队的音乐创作体验。

### 1.3 目标用户
- 音乐爱好者和业余音乐人
- 街头艺人和独立音乐创作者
- 想要体验音乐创作的普通用户
- 音乐教育工作者和学生

### 1.4 核心价值
- 降低音乐创作门槛，无需专业乐器
- 实时循环叠加，即时创作反馈
- 随时随地进行音乐创作和练习

---

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 录音功能
**优先级：P0（最高）**

- **实时录音**
  - 支持通过手机麦克风录制环境音（如敲桌面、拍手、人声等）
  - 支持最高 48kHz 采样率的高质量录音
  - 实时音频波形可视化显示
  - 支持音频增益调节（避免录音过小或爆音）

- **循环长度设置**
  - 预设循环长度：1/2/4/8/16 小节
  - 自定义循环长度（秒/拍子数）
  - 自动节拍检测（可选）
  - 节拍器辅助功能

- **录音控制**
  - 倒计时开始录音（让用户做好准备）
  - 录音时显示进度条和节拍提示
  - 自动循环点对齐（确保循环无缝衔接）

#### 2.1.2 循环播放功能
**优先级：P0**

- **基础循环**
  - 录音结束后自动开始循环播放
  - 无缝循环，确保首尾衔接流畅
  - 实时显示当前播放位置

- **循环控制**
  - 播放/暂停
  - 停止（停止所有循环轨道）
  - 速度调节（50%-200%，不改变音调）
  - 全局音量控制

#### 2.1.3 多轨叠加功能
**优先级：P0**

- **轨道管理**
  - 支持至少 8 条独立音轨
  - 每条轨道显示波形缩略图
  - 轨道颜色标识区分
  - 轨道重命名功能

- **轨道控制**
  - 独立的静音/独奏按钮
  - 每条轨道独立音量控制
  - 每条轨道独立左右声道平衡调节
  - 轨道删除和重录功能
  - 轨道顺序调整（上下拖动）

- **叠加录音**
  - 在现有循环播放时，叠加录制新轨道
  - 实时监听已有轨道 + 当前录音
  - 新轨道自动与已有轨道同步循环长度

#### 2.1.4 虚拟乐器功能
**优先级：P1**

- **预置乐器音色**
  - 打击乐器：架子鼓（底鼓、军鼓、嗵鼓、踩镲、crash 等）
  - 低音乐器：贝斯、大提琴
  - 和弦乐器：钢琴、吉他、合成器
  - 旋律乐器：萨克斯、小提琴、长笛
  - 人声效果：人声采样、Beatbox 音效

- **乐器界面**
  - 打击乐器：网格 Pad 界面（如 4x4 或 8x8）
  - 旋律乐器：虚拟键盘或琴键界面
  - 触控反馈和动画效果
  - 支持多点触控（同时触发多个音符）

- **音色调节**
  - 音高调节（移调）
  - 音色滤波器（低通/高通/带通）
  - 混响、延迟等基础音效

#### 2.1.5 音频处理功能
**优先级：P1**

- **音高调节**
  - 整体音高升降（半音为单位，±12 半音）
  - 保持原速度不变

- **音效处理**（每条轨道独立）
  - 混响（Reverb）：调节房间大小和混响量
  - 延迟（Delay）：回声效果
  - 均衡器（EQ）：低频/中频/高频调节
  - 压缩器（Compressor）：动态压缩
  - 失真（Distortion）：吉他失真效果（可选）

- **音频裁剪**
  - 裁剪录音的起始和结束点
  - 淡入/淡出效果

#### 2.1.6 保存与导出功能
**优先级：P0**

- **项目保存**
  - 保存整个项目（包含所有轨道和设置）
  - 项目列表管理
  - 项目重命名、复制、删除
  - 显示项目创建/修改时间

- **音频导出**
  - 导出为音频文件：WAV、MP3、M4A 格式
  - 音质选项：高/中/低（比特率可选）
  - 导出单独轨道或混合后的总轨
  - 分享到其他 App（微信、QQ、邮件等）

---

### 2.2 进阶功能

#### 2.2.1 节拍器与节奏辅助
**优先级：P1**

- 可视化节拍器（闪烁或动画提示）
- BPM（每分钟拍数）设置：40-240 BPM
- 节拍重音设置（如 4/4、3/4、6/8 拍）
- 节拍器音量独立调节
- 录音时节拍器辅助，播放时可关闭

#### 2.2.2 音频采样库
**优先级：P2**

- **预置采样包**
  - 常见打击乐音色（拍手、响指、鼓声等）
  - 环境音效（城市、自然、工业音效）
  - 音乐采样片段（循环素材）

- **自定义采样**
  - 用户可录制并保存自己的音色
  - 音色库管理（添加、删除、分类）
  - 从相册或文件导入音频作为采样

#### 2.2.3 音频可视化
**优先级：P2**

- 实时波形显示
- 频谱分析器
- 音量表（VU Meter）
- 多轨波形对齐显示

#### 2.2.4 社交与分享功能
**优先级：P2**

- 作品分享到社交媒体
- 生成作品视频（带波形动画）
- 社区功能：浏览其他用户作品（可选）
- 作品点赞、评论功能（可选）

#### 2.2.5 撤销与重做
**优先级：P1**

- 支持操作撤销和重做
- 保留最近 20 步操作历史

---

## 3. 用户界面需求

### 3.1 主界面布局

#### 3.1.1 录音/编辑界面（核心界面）
```
┌─────────────────────────────────────┐
│  [返回]  项目名称         [设置][?] │
├─────────────────────────────────────┤
│  ⏸ 播放   ⏹ 停止   🔄 循环中      │
│  [========>           ] 00:04/00:08 │
│  BPM: 120  [节拍器开关]             │
├─────────────────────────────────────┤
│  轨道列表：                          │
│  ┌───────────────────────────────┐  │
│  │ 🟢 Track 1 ▶️ 🔇 [波形图] 🎚 │  │
│  │ 🔵 Track 2 ▶️ 🔇 [波形图] 🎚 │  │
│  │ 🟡 Track 3 ▶️ 🔇 [波形图] 🎚 │  │
│  │ ➕ 添加新轨道                  │  │
│  └───────────────────────────────┘  │
├─────────────────────────────────────┤
│  录音源选择：                        │
│  [🎤 麦克风] [🎹 乐器] [📁 采样库]  │
├─────────────────────────────────────┤
│         🔴 录音按钮（大）            │
│       (长按准备，松手开始录音)        │
└─────────────────────────────────────┘
```

#### 3.1.2 项目列表界面
```
┌─────────────────────────────────────┐
│  我的项目              [+新建项目]   │
├─────────────────────────────────────┤
│  ┌───────────────────────────────┐  │
│  │ 项目 1                         │  │
│  │ 8 轨道 | 120 BPM | 02:30      │  │
│  │ 2025-12-02 14:30             │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ 项目 2                         │  │
│  │ 5 轨道 | 95 BPM | 01:45       │  │
│  │ 2025-12-01 20:15             │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### 3.1.3 虚拟乐器界面
```
┌─────────────────────────────────────┐
│  [返回]  架子鼓              [完成]  │
├─────────────────────────────────────┤
│  ┌─────┬─────┬─────┬─────┐          │
│  │ Hi- │Crash│Ride │     │          │
│  │ Hat │     │     │     │          │
│  ├─────┼─────┼─────┼─────┤          │
│  │High │ Mid │ Low │Floor│          │
│  │ Tom │ Tom │ Tom │ Tom │          │
│  ├─────┼─────┼─────┼─────┤          │
│  │Snare│Kick │Clap │     │          │
│  │     │     │     │     │          │
│  └─────┴─────┴─────┴─────┘          │
│                                      │
│  🔴 录音按钮                         │
└─────────────────────────────────────┘
```

### 3.2 UI/UX 设计原则

- **简洁直观**：新手用户 5 分钟内可上手
- **快速操作**：常用功能不超过 2 次点击
- **视觉反馈**：所有操作都有即时的视觉/音频反馈
- **深色模式**：支持浅色和深色主题切换
- **流畅动画**：界面过渡使用 60fps 流畅动画
- **适配屏幕**：适配 iPhone SE 到 iPhone Pro Max 全系列

---

## 4. 技术需求

### 4.1 开发技术栈

- **开发语言**：Swift 5.9+
- **开发框架**：SwiftUI（界面）+ UIKit（部分复杂交互）
- **最低支持版本**：iOS 16.0+
- **音频框架**：AVFoundation / AudioKit / Core Audio
- **存储**：Core Data（项目管理）+ FileManager（音频文件）

### 4.2 性能要求

- **延迟**：录音到播放延迟 < 50ms
- **同步精度**：多轨播放同步误差 < 10ms
- **启动速度**：App 冷启动时间 < 2 秒
- **内存占用**：运行时内存 < 200MB（8 轨道）
- **电池消耗**：连续使用 1 小时耗电 < 15%

### 4.3 音频技术要点

- **音频引擎**：AVAudioEngine 或 AudioKit
- **采样率**：48kHz
- **位深度**：16-bit 或 24-bit
- **缓冲区大小**：256 samples（低延迟）
- **音频格式**：内部使用 WAV，导出支持 MP3/M4A

### 4.4 数据存储

- **项目文件结构**：
  ```
  /Documents/Projects/
    ├── Project_001/
    │   ├── project.json (元数据)
    │   ├── track_1.wav
    │   ├── track_2.wav
    │   └── ...
    ├── Project_002/
    └── ...
  ```

- **元数据格式（project.json）**：
  ```json
  {
    "projectId": "001",
    "name": "我的作品",
    "bpm": 120,
    "loopLength": 8.0,
    "tracks": [
      {
        "id": 1,
        "name": "Track 1",
        "filePath": "track_1.wav",
        "volume": 0.8,
        "pan": 0.0,
        "muted": false,
        "effects": {...}
      }
    ],
    "createdAt": "2025-12-02T14:30:00Z",
    "modifiedAt": "2025-12-02T15:45:00Z"
  }
  ```

---

## 5. 非功能需求

### 5.1 稳定性

- App 无闪退，崩溃率 < 0.1%
- 音频录制不丢帧、不卡顿
- 长时间运行稳定（连续 2 小时无问题）

### 5.2 兼容性

- 支持 iPhone（iOS 16+）
- 支持 iPad（适配大屏幕布局）
- 支持横屏和竖屏
- 支持有线耳机和蓝牙耳机

### 5.3 可访问性

- 支持 VoiceOver（视障辅助）
- 支持动态字体大小
- 支持高对比度模式

### 5.4 隐私与安全

- 麦克风权限申请说明清晰
- 不上传用户数据（本地存储）
- 支持 Face ID / Touch ID 加密项目（可选）

---

## 6. 产品路线图

### Phase 1：MVP 版本（1-2 个月）
- ✅ 基础录音功能
- ✅ 循环播放
- ✅ 4 轨叠加
- ✅ 基础音量控制
- ✅ 项目保存与加载
- ✅ 音频导出（MP3）

### Phase 2：功能增强（2-3 个月）
- ✅ 增加到 8 轨
- ✅ 虚拟打击乐器
- ✅ 节拍器功能
- ✅ 基础音效（混响、延迟）
- ✅ 音高调节
- ✅ 轨道独奏/静音

### Phase 3：进阶功能（3-4 个月）
- ✅ 更多虚拟乐器（键盘、贝斯等）
- ✅ 高级音效（EQ、压缩器）
- ✅ 音频采样库
- ✅ 音频可视化增强
- ✅ iPad 适配

### Phase 4：社区与分享（4-6 个月）
- ✅ 作品视频导出
- ✅ 社交分享优化
- ✅ 用户社区（可选）
- ✅ 云端备份（可选）

---

## 7. 竞品分析

### 7.1 主要竞品

| 产品名称 | 优势 | 劣势 |
|---------|------|------|
| **GarageBand** | 功能强大，乐器丰富 | 复杂，学习曲线陡峭 |
| **Loopy HD** | 循环录音专业，操作流畅 | 界面较老，缺少虚拟乐器 |
| **Figure** | 简单易用，电音风格 | 功能有限，音色单一 |
| **BeatMaker** | 专业制作，采样强大 | 价格贵，不适合初学者 |

### 7.2 差异化优势

- **更低门槛**：比 GarageBand 更简单直观
- **专注循环**：比 Figure 更专业的循环叠加
- **混合创作**：支持麦克风录音 + 虚拟乐器结合
- **现代化界面**：SwiftUI 打造的流畅体验
- **免费使用**：核心功能免费，进阶功能内购

---

## 8. 商业模式

### 8.1 收费模式

- **免费版**（带广告）
  - 最多 4 轨道
  - 基础乐器音色
  - 基础音效
  - 项目数量限制 10 个

- **专业版**（一次性买断 ¥30-50）
  - 8 轨道
  - 所有乐器音色
  - 所有音效
  - 无限项目
  - 去除广告

- **订阅版**（可选，¥10/月）
  - 专业版所有功能
  - 持续更新的采样库
  - 云端备份（100GB）
  - 优先技术支持

### 8.2 推广策略

- App Store 优化（ASO）
- 社交媒体营销（抖音、B站演示视频）
- 音乐社区推广（即刻、微博）
- 与音乐教育机构合作

---

## 9. 风险与挑战

### 9.1 技术挑战

- **低延迟音频处理**：需要深入优化音频引擎
- **多轨同步**：确保长时间播放不漂移
- **内存管理**：多轨音频占用内存较大
- **音频格式兼容**：不同设备的音频表现一致性

### 9.2 产品风险

- **市场竞争**：GarageBand 功能强大且免费
- **用户留存**：工具类 App 打开频率较低
- **学习成本**：需要平衡功能和易用性

### 9.3 应对措施

- 专注核心体验（循环录音）形成差异化
- 社区功能提升用户粘性
- 持续迭代优化，快速响应用户反馈
- 教程和示例项目降低学习成本

---

## 10. 成功指标（KPI）

### 10.1 产品指标

- **下载量**：上线 3 个月 > 10,000
- **日活跃用户（DAU）**：> 1,000
- **用户留存率**：次日留存 > 40%，7 日留存 > 20%
- **付费转化率**：> 5%

### 10.2 体验指标

- **App Store 评分**：> 4.5 星
- **崩溃率**：< 0.1%
- **平均使用时长**：> 15 分钟/次

### 10.3 内容指标

- **创作项目数**：平均每用户 > 5 个项目
- **分享次数**：月分享次数 > 500

---

## 11. 附录

### 11.1 术语表

- **Loop（循环）**：音频片段重复播放
- **Track（轨道）**：独立的音频录音层
- **BPM（Beats Per Minute）**：每分钟拍数，音乐速度单位
- **Pan（声像）**：声音在左右声道的位置
- **Reverb（混响）**：模拟房间空间感的音效
- **Latency（延迟）**：音频输入到输出的时间差

### 11.2 参考资料

- Apple AVFoundation 官方文档
- AudioKit 开源音频框架
- iOS 人机界面指南（HIG）
- 音乐制作基础理论

---

## 12. 更新日志

| 版本 | 日期 | 更新内容 | 作者 |
|------|------|----------|------|
| v1.0 | 2025-12-02 | 初始版本，完成核心需求规划 | PRD Team |

---

**文档结束**

> 如有任何疑问或建议，请联系产品团队进行讨论和修订。

