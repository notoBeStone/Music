# 快速开始指南

## 前提条件

- macOS 14.0+
- Xcode 15.0+
- iOS 17.0+ 设备或模拟器

---

## 运行步骤

### 1. 打开项目
```bash
cd /Users/pengruilin/Document/Music
open Music.xcodeproj
```

### 2. 配置签名
1. 在 Xcode 中选择项目
2. 选择 "Music" target
3. 在 "Signing & Capabilities" 标签中
4. 选择你的 Team（或使用 Personal Team）

### 3. 运行应用
1. 选择目标设备（模拟器或真机）
2. 点击运行按钮 (⌘R)
3. 首次运行会请求麦克风权限，请允许

---

## 快速体验

### 创建第一个项目
1. App 启动后会显示项目列表（初始为空）
2. 点击右上角 "+" 按钮
3. 输入项目名称（如："我的第一首歌"）
4. 点击"创建"

### 录制第一条音轨
1. 进入项目后，看到 2x2 音轨网格
2. 点击中间的大红色录音按钮
3. 对着麦克风唱或说话
4. 达到循环长度（默认8秒）或再次点击停止
5. 录音自动保存并循环播放

### 录制第二条音轨（边放边录）
1. 第一条音轨会自动循环播放
2. 再次点击录音按钮
3. 听着第一条音轨的伴奏录制第二条
4. 停止后两条音轨同步循环播放

### 控制音轨
- **点击音轨卡片**: 切换静音
- **长按音轨卡片**: 打开详情页面
  - 编辑名称
  - 调整音量
  - 设置独奏
  - 删除音轨

### 播放控制
- **播放/暂停按钮**: 播放或暂停所有音轨
- **停止按钮**: 停止播放并回到开头
- **撤销按钮**: 撤销上一步操作
- **节拍器开关**: 打开节拍器（听到嘀嗒声）

### 导出作品
1. 点击右上角菜单按钮（三个点）
2. 选择"导出作品"
3. 选择格式（推荐 M4A）
4. 点击"开始导出"
5. 导出完成后可以分享

---

## 界面说明

```
┌─────────────────────────────────────┐
│  ← 项目   我的作品   •••            │  导航栏
├─────────────────────────────────────┤
│  BPM: 120    ⟲ ⏹ ⏯    🎵 节拍器   │  控制区
├─────────────────────────────────────┤
│  ┌─────┐ ┌─────┐                   │
│  │音轨1│ │音轨2│                   │  轨道区
│  └─────┘ └─────┘                   │  (2x2网格)
│  ┌─────┐ ┌─────┐                   │
│  │音轨3│ │音轨4│                   │
│  └─────┘ └─────┘                   │
├─────────────────────────────────────┤
│          ● 录音按钮                 │  录音区
│      点击开始/停止录音               │
└─────────────────────────────────────┘
```

---

## 常见问题

### Q: 为什么听不到录音？
A: 检查以下几点：
1. 麦克风权限是否允许
2. 音轨是否静音（卡片上有喇叭斜杠图标）
3. 设备音量是否打开

### Q: 录音延迟严重怎么办？
A: 
- 使用有线耳机（蓝牙有延迟）
- 关闭其他音频应用
- 在真机上测试（模拟器性能较差）

### Q: 最多可以录几条音轨？
A: MVP 版本限制为 4 条音轨

### Q: 循环长度可以修改吗？
A: 当前版本循环长度由 BPM 和小节数计算得出
   - 默认: 120 BPM, 4 小节 = 8 秒

### Q: 支持导入音频文件吗？
A: 当前版本仅支持麦克风录音，不支持导入

---

## 技术细节

### 音频配置
- 采样率: 48kHz
- 位深度: 16-bit
- 声道: 立体声
- 缓冲: 256 samples (~5ms 延迟)

### 文件存储
- 位置: `Documents/Projects/{ProjectID}/`
- 格式: WAV（录音）+ JSON（元数据）
- 导出: `Documents/Exports/`

### 快捷键（开发调试）
- ⌘R: 运行
- ⌘.: 停止
- ⌘K: 清理构建

---

## 下一步

1. **探索功能**: 尝试录制 4 条不同的音轨
2. **实验音效**: 调整各轨道音量，创造混音效果
3. **分享作品**: 导出并分享你的创作
4. **提供反馈**: 记录使用中的问题和建议

---

## 开发者工具

### 日志查看
在 Xcode 控制台可以看到详细日志：
- `[AudioEngineManager]`: 音频引擎操作
- `[ProjectRepository]`: 项目文件操作
- `[MainViewModel]`: 视图模型状态

### 调试模式
在代码中搜索 `#if DEBUG` 可以找到调试代码

### 清理缓存
如果遇到问题，可以删除项目文件：
```bash
rm -rf ~/Library/Developer/CoreSimulator/Devices/*/data/Containers/Data/Application/*/Documents/Projects
```

---

享受创作音乐的乐趣！🎵
